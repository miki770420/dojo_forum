<div class="well well-lg">
  <div class="row">
    <div class="col-md-12">
      <ul class="list-unstyled">
        <li>
          <% if image_path(@user.avatar).include?('/user'+ @user.id.to_s+'.jpg') %> 
            <%= image_tag('/avatar/user'+@user.id.to_s+'.jpg', size: "200x200", class: "img-responsive img-circle") %>
          <% else %>
            <% if @user.avatar? %>
              <%= image_tag @user.avatar.url, class: "img-responsive img-circle", size: "200x200" %>
            <% else %>
              no avatar
            <% end %>
          <% end %>
        </li>
        <li><strong><h3><%= link_to @user.name, user_path(@user) %></h3></strong></li>
        <li><h6><%= @user.description %></h6></li>
      </ul>
      <% if current_user == @user %>
        <%= link_to "Edit", edit_user_path(@user), class: "btn btn-primary pull-right" %>
      <% else %>
      <% end %>
    </div>
  </div>
</div>
<div class="col-md-12">
  <ul class="nav nav-tabs nav-justified"">
    <li class="active"><a href="#mypost" data-toggle="tab">My Post</a></li>
    <li><a href="#mycomment" data-toggle="tab">My Comment</a></li>
    <li><a href="#mycollect" data-toggle="tab">My Collect</a></li>
    <li><a href="#mydraft" data-toggle="tab">My Draft</a></li>
    <li><a href="#myfriend" data-toggle="tab">My Friend</a></li>
  </ul>
  <div id="myTabContent" class="tab-content">
    <div class="tab-pane fade active in" id="mypost">
      <table class="table">
        <tbody>
          <% @published_posts.each do |post| %>
            <tr>
              <td>
                <%= link_to "#{post.title}", post_path(post) %>
              </td>
              <td>
                Published
              </td>
              <td>
                <%= post.created_at.strftime("%F %T") %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="tab-pane fade" id="mycomment">
      <table class="table">
        <tbody>
          <% @replies.each do |reply| %>
          <tr>
            <td>
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h3 class="panel-title">
                    Post Title: <%= link_to "#{reply.post.title}", post_path(reply.post) %>
                  </h3>
                </div>
                <div class="panel-body">
                  <%= reply.comment %>
                  <br>
                  <%= link_to post_reply_path(reply.post, reply), method: :delete do %>
                    <button type="button" class="btn btn-default pull-right">
                      <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                    </button>
                  <% end %>
                  <%= link_to edit_post_reply_path(reply.post, reply) do %>
                    <button type="button" class="btn btn-default pull-right">
                      <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                    </button>
                  <% end %>
                </div>
              </div> 
            </td>
          </tr>
          <% end %>
        </tbody>
      </table>
      <div style="text-align: center">
        <%= paginate @replies, param_name: "replies_page" %>
      </div>
    </div>
    <div class="tab-pane fade" id="mycollect">
      <table class="table">
        <tbody>
          <% @collects.each do |collect| %>
            <tr>
              <td>
                <%= link_to "#{collect.title}", post_path(collect) %>
              </td>
              <td>
                <% if @user == current_user %>
                  <% if collect.is_collected?(@user) %>
                    <%= link_to 'Uncollect', uncollect_post_path(collect), method: :post, class: "btn btn-warning pull-right" %>
                  <% else %>
                    <%= link_to 'Collect', collect_post_path(collect), method: :post, class: "btn btn-primary pull-right" %>
                  <% end %>
                <% else %>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="tab-pane fade" id="mydraft">
      <table class="table">
        <tbody>
          <% @draft_posts.each do |post| %>
            <tr>
              <td>
                <%= link_to "#{post.title}", post_path(post) %>
              </td>
              <td>
                Draft
              </td>
              <td>
                <%= post.created_at.strftime("%F %T") %>
              </td>
              <td>
                <%= link_to post_path(post), method: :delete do %>
                  <button type="button" class="btn btn-default pull-right">
                    <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                  </button>
                <% end %>
                <%= link_to edit_post_path(post) do %>
                  <button type="button" class="btn btn-default pull-right">
                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                  </button>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <div class="tab-pane fade" id="myfriend">
      <% if @invitings.count > 0 %>
        <div class="col-md-12 text-center">
          <h4>Wait for response</h4>
          <% @invitings.each do |inviting| %>
            <div class="col-md-2">
              <%= link_to user_path(inviting) do %>
                <% if inviting.avatar? %>
                  <%= image_tag inviting.avatar.url, class: "img-responsive img-circle", size: "100x100" %>
                <% else %>
                  no avatar
                <% end %>
                <br>
                <%= inviting.name %>
              <% end %>
            </div>
          <% end %>
        </div>
      <% end %>
      <p></p>
      <% if @inviters.count > 0 %>
        <div class="col-md-12 text-center">
          <h4>Wait for your response</h4>
          <% @inviters.each do |inviter| %>
            <div class="col-md-2">
              <%= link_to user_path(inviter) do %>
                <% if inviter.avatar? %>
                  <%= image_tag inviter.avatar.url, class: "img-responsive img-circle", size: "100x100" %>
                <% else %>
                  no avatar
                <% end %>
                <br>
                <%= inviter.name %>
                <br>
                <%= render partial: "shared/friend_button", locals: {user: inviter} %>
              <% end %>
            </div>
          <% end %>
        </div>
      <% end %>
      <div class="col-md-12 text-center">
        <h4>your friends</h4>
        <% @friends.each do |friend| %>
          <div class="col-md-2">
            <%= link_to user_path(friend) do %>
              <% if friend.avatar? %>
                <%= image_tag friend.avatar.url, class: "img-responsive img-circle", size: "100x100" %>
              <% else %>
                no avatar
              <% end %>
              <br>
              <%= friend.name %>
            <% end %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>